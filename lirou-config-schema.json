{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "https://github.com/perryflynn/lirou/raw/master/lirou-config-schema.json",
    "title": "JSON schema a linux-router configuration file",
    "type": "object",
    "additionalProperties": false,
    "properties": {
        "lr": {
            "type": "object",
            "additionalProperties": false,
            "required": [ "hostname", "description", "admin", "contact", "root_password", "root_keys", "primary_address" ],
            "properties": {

                "hostname": { "type": "string" },
                "description": { "type": "string" },
                "admin": { "type": "string" },
                "contact": { "type": "string" },

                "networkeventlog": { "type": "boolean" },

                "root_password": { "type": "string" },
                "root_keys": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "required": [ "key", "comment" ],
                        "properties": {
                            "key": { "type": "string" },
                            "comment": { "type": "string" }
                        }
                    }
                },

                "primary_address": { "type": "string" },

                "ddns": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "additionalProperties": false,
                        "required": [ "name", "state", "provider", "interface", "properties" ],
                        "properties": {
                            "name": { "type": "string" },
                            "state": { "type": "string", "enum": [ "absent", "present" ] },
                            "provider": { "type": "string", "enum": [ "nsupdate" ] },
                            "interface": { "type": "string" },
                            "properties": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": [ "server", "domain", "keyfile" ],
                                "properties": {
                                    "server": { "type": "string" },
                                    "domain": { "type": "string" },
                                    "keyfile": { "type": "string" }
                                }
                            }
                        }
                    }
                },

                "wifi": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                        "enabled": { "type": "boolean" },
                        "name": { "type": "string" },
                        "country": { "type": "string" },
                        "channel": { "type": "integer" },
                        "phyname": { "type": "string" },
                        "mac": { "type": "string" },
                        "driver": { "type": "string", "enum": [ "nl80211" ] },
                        "software": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": [ "name", "description", "state", "mode", "mac", "ssid", "passphrase" ],
                                "properties": {
                                    "name": { "type": "string" },
                                    "description": { "type": "string" },
                                    "state": { "type": "string", "enum": [ "absent", "present" ] },
                                    "mode": { "type": "string", "enum": [ "station", "ap" ] },
                                    "mac": { "type": "string" },
                                    "ssid": { "type": "string" },
                                    "passphrase": { "type": "string" }
                                }
                            }
                        }
                    },
                    "oneOf": [
                        {
                            "properties": { "enabled": { "const": true } },
                            "required": [ "enabled", "name", "country", "channel", "phyname", "mac", "driver", "software" ]
                        },
                        {
                            "properties": { "enabled": { "const": false } },
                            "required": [ "enabled" ]
                        }
                    ]
                },

                "lans": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "additionalProperties": false,
                        "required": [ "name", "description", "state" ],
                        "properties": {

                            "name": { "type": "string" },
                            "description": { "type": "string" },
                            "state": { "type": "string", "enum": [ "absent", "present" ] },

                            "dhcpclient": { "type": "boolean" },
                            "pull_gateway": { "type": "boolean" },
                            "pull_routes": { "type": "boolean" },
                            "upstream": { "type": "boolean" },

                            "address": { "type": "string" },
                            "prefix": { "type": "integer", "minimum": 0, "maximum": 32 },

                            "vlan": { "type": "boolean" },
                            "vid": { "type": "integer", "minimum": 1, "maximum": 4096 },
                            "interface": { "type": "string" },

                            "bridge": { "type": "boolean" },
                            "interfaces": {
                                "type": "array",
                                "minItems": 1,
                                "maxItems": 999,
                                "uniqueItems": true,
                                "items": {
                                    "type": "string"
                                }
                            },

                            "dhcp": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": [ "start", "end", "lease" ],
                                "properties": {
                                    "start": { "type": "string" },
                                    "end": { "type": "string" },
                                    "lease": { "type": "string" }
                                }
                            },

                            "routes": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "additionalProperties": false,
                                    "required": [ "description", "destination", "gateway" ],
                                    "properties": {
                                        "description": { "type": "string" },
                                        "destination": { "type": "string" },
                                        "gateway": { "type": "string" }
                                    }
                                }
                            },

                            "additionalips": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "additionalProperties": false,
                                    "required": [ "name", "address", "netmask" ],
                                    "properties": {
                                        "name": { "type": "string" },
                                        "address": { "type": "string" },
                                        "netmask": { "type": "integer", "minimum": 0, "maximum": 32 }
                                    }
                                }
                            }

                        }
                    }
                },

                "dnat": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "additionalProperties": false,
                        "required": [ "src", "dest" ],
                        "properties": {
                            "src": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": [ "intf", "addr" ],
                                "properties": {
                                    "intf": { "type": "string" },
                                    "addr": { "type": "string" }
                                }
                            },
                            "dest": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": [ "addr" ],
                                "properties": {
                                    "addr": { "type": "string" }
                                }
                            }
                        }
                    }
                }

            }
        }
    }
}
